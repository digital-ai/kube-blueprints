---
{{ if  eq .K8sSetup "DockerDesktopK8s" }}
apiVersion: xl-deploy/v1
kind: Applications
spec:
  - name: Applications/DIGITALAI/release-operator-app
    type: udm.Application
    children:
    - name: {{ .ImageTag }}
      type: udm.DeploymentPackage
      deployables:
      - name: manager-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "22"
        modifyOrder: "23"
        destroyOrder: "24"
        file: !file "dai-release/template-onprem/manager-rolebinding.yaml"
      - name: cluster-role-metrics-reader
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "13"
        modifyOrder: "14"
        destroyOrder: "15"
        file: !file "dai-release/template-onprem/cluster-role-metrics-reader.yaml"
      - name: leader-election-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "19"
        modifyOrder: "20"
        destroyOrder: "21"
        file: !file "dai-release/template-onprem/leader-election-rolebinding.yaml"
      - name: controller-manager-metrics-service
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "28"
        modifyOrder: "29"
        destroyOrder: "30"
        file: !file "dai-release/template-onprem/controller-manager-metrics-service.yaml"
      - name: deployment
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "31"
        modifyOrder: "32"
        destroyOrder: "33"
        file: !file "dai-release/template-onprem/deployment.yaml"
      - name: leader-election-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "7"
        modifyOrder: "8"
        destroyOrder: "9"
        file: !file "dai-release/template-onprem/leader-election-role.yaml"
      - name: cluster-role-manager-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "10"
        modifyOrder: "11"
        destroyOrder: "12"
        file: !file "dai-release/template-onprem/cluster-role-manager-role.yaml"
      - name: custom-resource-definition
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "3"
        modifyOrder: "2"
        destroyOrder: "1"
        file: !file "dai-release/template-onprem/custom-resource-definition.yaml"
      - name: cluster-role-digital-proxy-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "16"
        modifyOrder: "17"
        destroyOrder: "18"
        file: !file "dai-release/template-onprem/cluster-role-digital-proxy-role.yaml"
      - name: proxy-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "25"
        modifyOrder: "26"
        destroyOrder: "27"
        file: !file "dai-release/template-onprem/proxy-rolebinding.yaml"
---
apiVersion: xl-deploy/v1
kind: Applications
spec:
- name: Applications/DIGITALAI/dai-release-cr
  type: udm.Application
  children:
  - name: {{ .ImageTag }}
    type: udm.DeploymentPackage
    deployables:
    - name: cr-file
      type: k8s.ResourcesFile
      scanPlaceholders: false
      fileEncodings:
        ".+\\.properties": ISO-8859-1
      mergePatchType: strategic
      propagationPolicy: Foreground
      updateMethod: patch
      createOrder: "60"
      modifyOrder: "50"
      destroyOrder: "40"
      file: !file "dai-release/dairelease_cr.yaml"
{{ else if eq .K8sSetup "openshift" }}
apiVersion: xl-deploy/v1
kind: Applications
spec:
  - name: Applications/DIGITALAI/release-operator-app
    type: udm.Application
    children:
    - name: {{ .ImageTag }}
      type: udm.DeploymentPackage
      deployables:
      - name: manager-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "22"
        modifyOrder: "23"
        destroyOrder: "24"
        file: !file "dai-release/template-openshift/manager-rolebinding.yaml"
      - name: cluster-role-metrics-reader
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "13"
        modifyOrder: "14"
        destroyOrder: "15"
        file: !file "dai-release/template-openshift/cluster-role-metrics-reader.yaml"
      - name: leader-election-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "19"
        modifyOrder: "20"
        destroyOrder: "21"
        file: !file "dai-release/template-openshift/leader-election-rolebinding.yaml"
      - name: controller-manager-metrics-service
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "28"
        modifyOrder: "29"
        destroyOrder: "30"
        file: !file "dai-release/template-openshift/controller-manager-metrics-service.yaml"
      - name: deployment
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "31"
        modifyOrder: "32"
        destroyOrder: "33"
        file: !file "dai-release/template-openshift/deployment.yaml"
      - name: leader-election-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "7"
        modifyOrder: "8"
        destroyOrder: "9"
        file: !file "dai-release/template-openshift/leader-election-role.yaml"
      - name: cluster-role-manager-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "10"
        modifyOrder: "11"
        destroyOrder: "12"
        file: !file "dai-release/template-openshift/cluster-role-manager-role.yaml"
      - name: custom-resource-definition
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "3"
        modifyOrder: "2"
        destroyOrder: "1"
        file: !file "dai-release/template-openshift/custom-resource-definition.yaml"
      - name: cluster-role-digital-proxy-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "16"
        modifyOrder: "17"
        destroyOrder: "18"
        file: !file "dai-release/template-openshift/cluster-role-digital-proxy-role.yaml"
      - name: proxy-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "25"
        modifyOrder: "26"
        destroyOrder: "27"
        file: !file "dai-release/template-openshift/proxy-rolebinding.yaml"
---
apiVersion: xl-deploy/v1
kind: Applications
spec:
- name: Applications/DIGITALAI/dai-release-cr
  type: udm.Application
  children:
  - name: {{ .ImageTag }}
    type: udm.DeploymentPackage
    deployables:
    - name: cr-file
      type: k8s.ResourcesFile
      scanPlaceholders: false
      fileEncodings:
        ".+\\.properties": ISO-8859-1
      mergePatchType: strategic
      propagationPolicy: Foreground
      updateMethod: patch
      createOrder: "60"
      modifyOrder: "50"
      destroyOrder: "40"
      file: !file "dai-release/dairelease_cr.yaml"
{{ else if  eq .K8sSetup "PlainK8SCluster" }}
apiVersion: xl-deploy/v1
kind: Applications
spec:
  - name: Applications/DIGITALAI/release-operator-app
    type: udm.Application
    children:
    - name: {{ .ImageTag }}
      type: udm.DeploymentPackage
      deployables:
      - name: manager-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "22"
        modifyOrder: "23"
        destroyOrder: "24"
        file: !file "dai-release/template-onprem/manager-rolebinding.yaml"
      - name: cluster-role-metrics-reader
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "13"
        modifyOrder: "14"
        destroyOrder: "15"
        file: !file "dai-release/template-onprem/cluster-role-metrics-reader.yaml"
      - name: leader-election-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "19"
        modifyOrder: "20"
        destroyOrder: "21"
        file: !file "dai-release/template-onprem/leader-election-rolebinding.yaml"
      - name: controller-manager-metrics-service
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "28"
        modifyOrder: "29"
        destroyOrder: "30"
        file: !file "dai-release/template-onprem/controller-manager-metrics-service.yaml"
      - name: deployment
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "31"
        modifyOrder: "32"
        destroyOrder: "33"
        file: !file "dai-release/template-onprem/deployment.yaml"
      - name: leader-election-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "7"
        modifyOrder: "8"
        destroyOrder: "9"
        file: !file "dai-release/template-onprem/leader-election-role.yaml"
      - name: cluster-role-manager-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "10"
        modifyOrder: "11"
        destroyOrder: "12"
        file: !file "dai-release/template-onprem/cluster-role-manager-role.yaml"
      - name: custom-resource-definition
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "3"
        modifyOrder: "2"
        destroyOrder: "1"
        file: !file "dai-release/template-onprem/custom-resource-definition.yaml"
      - name: cluster-role-digital-proxy-role
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "16"
        modifyOrder: "17"
        destroyOrder: "18"
        file: !file "dai-release/template-onprem/cluster-role-digital-proxy-role.yaml"
      - name: proxy-rolebinding
        type: k8s.ResourcesFile
        fileEncodings:
          ".+\\.properties": ISO-8859-1
        mergePatchType: strategic
        propagationPolicy: Foreground
        updateMethod: patch
        createOrder: "25"
        modifyOrder: "26"
        destroyOrder: "27"
        file: !file "dai-release/template-onprem/proxy-rolebinding.yaml"
---
apiVersion: xl-deploy/v1
kind: Applications
spec:
- name: Applications/DIGITALAI/dai-release-cr
  type: udm.Application
  children:
  - name: {{ .ImageTag }}
    type: udm.DeploymentPackage
    deployables:
    - name: cr-file
      type: k8s.ResourcesFile
      scanPlaceholders: false
      fileEncodings:
        ".+\\.properties": ISO-8859-1
      mergePatchType: strategic
      propagationPolicy: Foreground
      updateMethod: patch
      createOrder: "60"
      modifyOrder: "50"
      destroyOrder: "40"
      file: !file "dai-release/dairelease_cr.yaml"
{{ end }}